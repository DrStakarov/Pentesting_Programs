from queue import Queue
import threading, socket

domain = "dominio.com"
lock = threading.Lock()
def brute():
    while q.empty() != False:
        DNS = q.get() + "." + domain
        try:
            IP = socket.gethostbyname(DNS)
            lock.acquire()
            print(DNS, "\t|\t", IP)
        except socket.gaierror:
            pass
        else:
            lock.release()
        q.task_done()
q = Queue()
for i in range(20):
    t = threading.Thread(target=brute)
    t.daemon = True
    t.start()
with open("dns_brute.txt") as archive:
    while True:
        name = archive.readline().strip("\n")
        if not name:
            break
        q.put(name)
q.join()
print("\n[+]Finished!")